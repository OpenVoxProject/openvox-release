pipeline {
  agent  {
    label 'k8s-worker'
  }

  options {
    timestamps()
    ansiColor('xterm')
    preserveStashes(buildCount: 15)
  }

  environment {
    ABS_TOKEN = credentials('always-be-scheduling-k8s')
    ARTIFACTORY_API_TOKEN = credentials('api_token_for_jenkins_to_artifactory')
  }
  stages {
    stage('Ship') {
      steps {
        script {
          sh "touch hello.txt"
          sh "curl -u jenkins:$ARTIFACTORY_API_TOKEN -X PUT "https://artifactory.delivery.puppetlabs.net/artifactory/release-engineering/hello.txt" -T hello.txt"
        }
      }
    }
  }
}